"use strict";(self["webpackChunkping_fan_green"]=self["webpackChunkping_fan_green"]||[]).push([[889],{2377:function(e,t,a){a.d(t,{Z:function(){return g}});var s=a(3396),l=a(7139),i=a(9242);const n={"aria-label":"Page navigation"},r={class:"pagination justify-content-center"},o=["onClick","onKeyup"];function d(e,t,a,d,c,p){return(0,s.wg)(),(0,s.iD)("nav",n,[(0,s._)("ul",r,[(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pagination.has_pre}])},[(0,s._)("a",{class:"page-link",onClick:t[0]||(t[0]=(0,i.iM)((e=>p.changePage(a.pagination.current_page-1)),["prevent"])),onKeyup:t[1]||(t[1]=(0,i.iM)((e=>p.changePage(a.pagination.current_page-1)),["prevent"]))},"上一頁",32)],2),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.pagination.total_pages,(e=>((0,s.wg)(),(0,s.iD)("li",{class:(0,l.C_)(["page-item",{active:a.pagination.current_page===e}]),key:e+"dadfsd"},[(0,s._)("a",{class:"page-link",onClick:(0,i.iM)((t=>p.changePage(e)),["prevent"]),onKeyup:(0,i.iM)((t=>p.changePage(e)),["prevent"])},(0,l.zw)(e),41,o)],2)))),128)),(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pagination.has_next}])},[(0,s._)("a",{class:"page-link",onClick:t[2]||(t[2]=(0,i.iM)((e=>p.changePage(a.pagination.current_page+1)),["prevent"])),onKeyup:t[3]||(t[3]=(0,i.iM)((e=>p.changePage(a.pagination.current_page+1)),["prevent"]))},"下一頁",32)],2)])])}var c={props:["pagination"],methods:{changePage(e){this.$emit("change-page",e)}}},p=a(89);const u=(0,p.Z)(c,[["render",d]]);var g=u},5888:function(e,t,a){a.d(t,{Z:function(){return i}});var s={methods:{successFire(e){this.$swal({icon:"success",title:e})},warningFire(e){this.$swal({icon:"warning",title:e})},failFire(e){this.$swal({icon:"error",title:e})}}};const l=s;var i=l},3770:function(e,t,a){a.d(t,{Z:function(){return b}});var s=a(3396),l=a(7139);const i={class:"modal fade",id:"deleteModal",tabindex:"-1","aria-labelledby":"deleteModal","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog"},r={class:"modal-content"},o=(0,s._)("div",{class:"modal-header"},[(0,s._)("h5",{class:"modal-title"},"再次確認"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),d={class:"modal-body"},c={class:"modal-footer"},p=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function u(e,t,a,u,g,h){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",i,[(0,s._)("div",n,[(0,s._)("div",r,[o,(0,s._)("div",d,[(0,s._)("p",null,"確認刪除 "+(0,l.zw)(e.deleteItem.title)+" ？",1)]),(0,s._)("div",c,[p,(0,s._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>h.executeDelete&&h.executeDelete(...e))},"確認")])])])],512)])}var g=a(8290),h={props:["delete-item"],mixins:[g.Z],methods:{executeDelete(){this.$emit("emit-delete")}}},_=a(89);const m=(0,_.Z)(h,[["render",u]]);var b=m},889:function(e,t,a){a.r(t),a.d(t,{default:function(){return he}});var s=a(3396),l=a(7139);const i={class:"container my-5"},n={class:"d-flex justify-content-between mb-3"},r=(0,s._)("h2",null,"訂單列表",-1),o={class:"table-responsive"},d={class:"table align-middle mb-4"},c=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"購買時間"),(0,s._)("th",null,"Email"),(0,s._)("th",null,"商品項目"),(0,s._)("th",null,"應付金額"),(0,s._)("th",null,"是否付款"),(0,s._)("th",{class:"text-end"},"操作")])],-1),p={key:0},u=(0,s._)("td",{colspan:"6"},"目前沒有訂單",-1),g=[u],h={class:"list-unstyled mb-0"},_={class:"form-check"},m=["id","checked","onChange"],b=["for"],v={key:0,class:"text-success"},f={key:1,class:"text-danger"},w={class:"text-end"},y={class:"btn-group",role:"group","aria-label":"Basic example"},D=["onClick"],k=["onClick"];function O(e,t,a,u,O,C){const M=(0,s.up)("PaginationComponent"),x=(0,s.up)("DeleteConfirm"),z=(0,s.up)("OrderModal");return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",n,[r,(0,s._)("button",{class:"btn btn-danger",type:"button",onClick:t[0]||(t[0]=e=>C.openDeleteModal(!0))},"刪除所有訂單")]),(0,s._)("div",o,[(0,s._)("table",d,[c,(0,s._)("tbody",null,[0===O.orders.length?((0,s.wg)(),(0,s.iD)("tr",p,g)):((0,s.wg)(!0),(0,s.iD)(s.HY,{key:1},(0,s.Ko)(O.orders,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,(0,l.zw)(C.changeDate(e.create_at)),1),(0,s._)("td",null,(0,l.zw)(e.user.email),1),(0,s._)("td",null,[(0,s._)("ul",h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.products,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id},(0,l.zw)(e.product.title)+" 數量："+(0,l.zw)(e.qty)+" "+(0,l.zw)(e.product.unit),1)))),128))])]),(0,s._)("td",null,(0,l.zw)(e.total),1),(0,s._)("td",null,[(0,s._)("div",_,[(0,s._)("input",{class:"form-check-input",type:"checkbox",id:`isPaidfor${e.id}`,checked:e.is_paid,onChange:t=>C.updateOrderPaid(e)},null,40,m),(0,s._)("label",{class:"form-check-label",for:`isPaidfor${e.id}`},[e.is_paid?((0,s.wg)(),(0,s.iD)("span",v,"已付款")):((0,s.wg)(),(0,s.iD)("span",f,"未付款"))],8,b)])]),(0,s._)("td",w,[(0,s._)("div",y,[(0,s._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t=>C.openOrderModal(e)}," 檢視 ",8,D),(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>C.openDeleteModal(!1,e)}," 刪除 ",8,k)])])])))),128))])]),(0,s.Wm)(M,{pagination:O.pagination,onChangePage:C.getOrders},null,8,["pagination","onChangePage"])]),(0,s.Wm)(x,{ref:"deleteModal","delete-item":O.tempOrder,onEmitDelete:C.deleteOrder},null,8,["delete-item","onEmitDelete"]),(0,s.Wm)(z,{ref:"orderModal",order:O.tempOrder,onEmitPage:C.getOrders},null,8,["order","onEmitPage"])])}var C=a(2377);const M={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"orderModal","aria-hidden":"true",ref:"modal"},x={class:"modal-dialog modal-lg"},z={class:"modal-content"},P=(0,s._)("div",{class:"modal-header"},[(0,s._)("h4",{class:"modal-title"},"檢視訂單"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},Z={class:"row"},F={class:"col-6"},K=(0,s._)("h5",null,"訂單資訊",-1),E={class:"list-group list-group-flush"},A={class:"list-group-item"},H={class:"list-group-item"},Y={class:"list-group-item"},j={class:"list-group-item"},W=(0,s.Uk)("付款狀態： "),q={key:0},B={key:1},I={class:"col-6"},L=(0,s._)("h5",null,"訂購人資訊",-1),N={class:"list-group list-group-flush"},S={class:"list-group-item"},T={class:"list-group-item"},U={class:"list-group-item"},G={class:"list-group-item"},J=(0,s._)("h5",{class:"text-center mt-3"},"訂購商品",-1),Q={class:"table table-borderless table-hover"},R=(0,s._)("thead",null,[(0,s._)("tr",{class:"border-bottom"},[(0,s._)("th",{scope:"col"},"名稱"),(0,s._)("th",{scope:"col"},"單價"),(0,s._)("th",{scope:"col"},"數量/單位"),(0,s._)("th",{scope:"col"},"單項總金額")])],-1),V={scope:"row"},X={class:"text-center"},ee=(0,s._)("h5",null,"留言",-1),te={key:0},ae={key:1},se=(0,s._)("div",{class:"modal-footer"},[(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ")],-1);function le(e,t,a,i,n,r){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",M,[(0,s._)("div",x,[(0,s._)("div",z,[P,(0,s._)("div",$,[(0,s._)("div",Z,[(0,s._)("div",F,[K,(0,s._)("ul",E,[(0,s._)("li",A,"訂單編號： "+(0,l.zw)(a.order.id),1),(0,s._)("li",H,"訂單日期： "+(0,l.zw)(a.order.create_at),1),(0,s._)("li",Y,"總金額： "+(0,l.zw)(a.order.total),1),(0,s._)("li",j,[W,a.order.is_paid?((0,s.wg)(),(0,s.iD)("span",q,"已付款")):((0,s.wg)(),(0,s.iD)("span",B,"未付款"))])])]),(0,s._)("div",I,[L,(0,s._)("ul",N,[(0,s._)("li",S,"姓名： "+(0,l.zw)(a.order.user?.name),1),(0,s._)("li",T,"信箱： "+(0,l.zw)(a.order.user?.email),1),(0,s._)("li",U,"電話： "+(0,l.zw)(a.order.user?.tel),1),(0,s._)("li",G,"地址： "+(0,l.zw)(a.order.user?.address),1)])])]),J,(0,s._)("table",Q,[R,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.order.products,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("th",V,(0,l.zw)(e.product.title),1),(0,s._)("td",null,(0,l.zw)(e.product.price),1),(0,s._)("td",null,(0,l.zw)(e.qty)+" / "+(0,l.zw)(e.product.unit),1),(0,s._)("td",null,"NT$ "+(0,l.zw)(e.total),1)])))),128))])]),(0,s._)("div",X,[ee,a.order.message?((0,s.wg)(),(0,s.iD)("p",te,(0,l.zw)(a.order.message),1)):((0,s.wg)(),(0,s.iD)("p",ae,"這筆訂單沒有留言喔~"))])]),se])])],512)])}var ie=a(8290),ne={mixins:[ie.Z],props:{order:{type:Object,default(){return{}}}}},re=a(89);const oe=(0,re.Z)(ne,[["render",le]]);var de=oe,ce=a(3770),pe=a(5888),ue={data(){return{orders:[],pagination:{},tempOrder:{},isDeleteAll:!1}},mixins:[pe.Z],components:{PaginationComponent:C.Z,OrderModal:de,DeleteConfirm:ce.Z},methods:{getOrders(e=1){const t=this.$loading.show();this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/pingfangreen/admin/orders?page=${e}`).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,t.hide()})).catch((e=>{this.failFire(e.response.data.message),t.hide()}))},updateOrderPaid(e){this.tempOrder={...e},this.tempOrder.is_paid=!e.is_paid,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/pingfangreen/admin/order/${this.tempOrder.id}`,{data:this.tempOrder}).then((e=>{this.successFire(e.data.message),this.getOrders()})).catch((e=>{this.failFire(e.response.data.message)}))},openOrderModal(e){this.tempOrder={...e},this.tempOrder.create_at=this.changeDate(e.create_at);const t=this.$refs.orderModal;t.openModal()},changeDate(e){return new Date(1e3*e).toLocaleDateString()},openDeleteModal(e,t){e?this.isDeleteAll=!0:(this.isDeleteAll=!1,this.tempOrder={...t},this.tempOrder.create_at=this.changeDate(t.create_at));const a=this.$refs.deleteModal;a.openModal()},deleteOrder(){let e=`https://vue3-course-api.hexschool.io/v2/api/pingfangreen/admin/order/${this.tempOrder.id}`;this.isDeleteAll&&(e="https://vue3-course-api.hexschool.io/v2/api/pingfangreen/admin/orders/all"),this.$http.delete(e).then((e=>{this.getOrders();const t=this.$refs.deleteModal;t.closeModal(),this.successFire(e.data.message)})).catch((e=>{this.failFire(e.response.data.message)}))}},mounted(){this.getOrders()}};const ge=(0,re.Z)(ue,[["render",O]]);var he=ge}}]);
//# sourceMappingURL=889.b31ca9d5.js.map